<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<form id="__vtigerWebForm" name="Registro de Agente" action="http://193.164.131.221/Sirenis/modules/Webforms/capture.php" method="post" accept-charset="utf-8" enctype="multipart/form-data">
	<input type="hidden" name="__vtrftk" value="sid:f0710bed0054fd870c9d5f490082f83f229841c2,1546600439">
	<input type="hidden" name="publicid" value="7c145941ca5863c4ec365df775778c8a">
	<input type="hidden" name="urlencodeenable" value="1"><input type="hidden" name="name" value="Registro de Agente">
	<table>
		<tbody>
			<tr>
				<td>
					<label>Lastname*</label>
				</td>
				<td>
					<input type="text" name="lastname" data-label="" value="" required="">
				</td>
			</tr>
			<tr>
				<td>
					<label>Name</label>
				</td>
				<td>
					<input type="text" name="firstname" data-label="" value="">
				</td>
			</tr>
			<tr>
				<td>
					<label>Agency Type*</label>
				</td>
				<td>
					<select name="agency_type" data-label="agency_type" required="">
						<option value="">--Selecciona Valor--</option>
						<option value="ABTA">ABTA</option>
						<option value="ARC">ARC</option>
						<option value="CLIA">CLIA</option>
						<option value="IATAN">IATAN</option>
						<option value="Other">Otro</option>
					</select>
				</td>
			</tr>
			<tr>
				<td>
					<label>Agency Number*</label>
				</td>
				<td>
					<input type="text" name="agency_number" data-label="" value="" required="">
				</td>
			</tr>
			<tr>
				<td>
					<label>Number of employees*</label>
				</td>
				<td>
					<input type="number" name="number_employees" data-label="" value="" required="" datatype="double" step="any">
				</td>
			</tr>
			<tr>
				<td>
					<label>Number of locations*</label>
				</td>
				<td>
					<input type="number" name="number_locations" data-label="" value="" required="" datatype="double" step="any">
				</td>
			</tr>
			<tr>
				<td>
					<label>Agency Name*</label>
				</td>
				<td>
					<input type="text" name="agency_name" data-label="" value="" required="">
				</td>
			</tr>
			<tr>
				<td>
					<label>Number of Storefronts</label>
				</td>
				<td>
					<select name="number_storefronts" data-label="number_storefronts">
						<option value="">--Selecciona Valor--</option>
						<option value="0">0</option>
						<option value="1">1</option>
						<option value="2">2</option>
						<option value="3">3</option>
						<option value="4">4</option>
						<option value="5">5</option>
						<option value="6">6</option>
						<option value="7">7</option>
						<option value="8">8</option>
						<option value="9">9</option>
						<option value="10">10</option>
						<option value="11">11</option>
						<option value="12">12</option>
						<option value="13">13</option>
						<option value="14">14</option>
						<option value="15">15</option>
						<option value="16">16</option>
						<option value="17">17</option>
						<option value="18">18</option>
						<option value="19">19</option>
						<option value="20">20</option>
						<option value="21">21</option>
						<option value="22">22</option>
						<option value="23">23</option>
						<option value="24">24</option>
						<option value="25">25</option>
						<option value="+25">+25</option>
					</select>
				</td>
			</tr>
			<tr>
				<td>
					<label>Country</label>
				</td>
				<td>
					<select name="mailingcountry" data-label="mailingcountry">
						<option value = "United States">United States</option>
					</select>
				</td>
			</tr>
			<tr>
				<td>
					<label>Agency Kind*</label>
				</td>
				<td>
					<select name="agency_kind" data-label="agency_kind" required="">
						<option value="">--Selecciona Valor--</option>
						<option value="Storefront">Storefront</option>
						<option value="Homebased">Homebased</option>
						<option value="Online">Online</option>
						<option value="Offline">Offline</option>
					</select>
				</td>
			</tr>
			<tr>
				<td>
					<label>City*</label>
				</td>
				<td>
					<input type="text" name="city" data-label="" value="" required="">
				</td>
			</tr>
			<tr>
				<td>
					<label>Travel Affiliation*</label>
				</td>
				<td>
					<select name="travel_affiliation" data-label="travel_affiliation" required="">
						<option value="">--Selecciona Valor--</option>
						<option value="AAA">AAA</option>
						<option value="Advantage">Advantage</option>
						<option value="AMEX">AMEX</option>
						<option value="Barrhead Travel">Barrhead Travel</option>
						<option value="Co-Operate Travel">Co-Operate Travel</option>
						<option value="CWT">CWT</option>
						<option value="ENSEMBLE">ENSEMBLE</option>
						<option value="Etravco">Etravco</option>
						<option value="Global Travel Group">Global Travel Group</option>
						<option value="Hays Travel">Hays Travel</option>
						<option value="JOURNEY">JOURNEY</option>
						<option value="MAST">MAST</option>
						<option value="OTHER">OTHER</option>
						<option value="Other Independient">Other Independient</option>
						<option value="SIGNATURE">SIGNATURE</option>
						<option value="Travel Counselors">Travel Counselors</option>
						<option value="Travel House">Travel House</option>
						<option value="TRAVELSAVERS">TRAVELSAVERS</option>
						<option value="TUI Specialist Division">TUI Specialist Division</option>
						<option value="VACATIONS.COM">VACATIONS.COM</option>
						<option value="VIRTUOSO">VIRTUOSO</option>
					</select>
				</td>
			</tr>
			<tr>
				<td>
					<label>State</label>
				</td>
				<td>
					<select name="state" data-label="state">
						<option value="">--Selecciona Valor--</option>
						<option value="Alabama">Alabama</option>
						<option value="Alaska">Alaska</option>
						<option value="Arizona">Arizona</option>
						<option value="Arkansas">Arkansas</option>
						<option value="California">California</option>
						<option value="Colorado">Colorado</option>
						<option value="Connecticut">Connecticut</option>
						<option value="Delaware">Delaware</option>
						<option value="District Of Columbia">District Of Columbia</option>
						<option value="Florida">Florida</option>
						<option value="Georgia">Georgia</option>
						<option value="Hawaii">Hawaii</option>
						<option value="Idaho">Idaho</option>
						<option value="Illinois">Illinois</option>
						<option value="Indiana">Indiana</option>
						<option value="Iowa">Iowa</option>
						<option value="Kansas">Kansas</option>
						<option value="Kentucky">Kentucky</option>
						<option value="Louisiana">Louisiana</option>
						<option value="Maine">Maine</option>
						<option value="Maryland">Maryland</option>
						<option value="Massachusetts">Massachusetts</option>
						<option value="Michigan">Michigan</option>
						<option value="Minnesota">Minnesota</option>
						<option value="Mississippi">Mississippi</option>
						<option value="Missouri">Missouri</option>
						<option value="Montana">Montana</option>
						<option value="Nebraska">Nebraska</option>
						<option value="Nevada">Nevada</option>
						<option value="New Hampshire">New Hampshire</option>
						<option value="New Jersey">New Jersey</option>
						<option value="New Mexico">New Mexico</option>
						<option value="New York">New York</option>
						<option value="North Carolina">North Carolina</option>
						<option value="North Dakota">North Dakota</option>
						<option value="Ohio">Ohio</option>
						<option value="Oklahoma">Oklahoma</option>
						<option value="Oregon">Oregon</option>
						<option value="Pennsylvania">Pennsylvania</option>
						<option value="Rhode Island">Rhode Island</option>
						<option value="South Carolina">South Carolina</option>
						<option value="South Dakota">South Dakota</option>
						<option value="Tennessee">Tennessee</option>
						<option value="Texas">Texas</option>
						<option value="Utah">Utah</option>
						<option value="Vermont">Vermont</option>
						<option value="Virginia">Virginia</option>
						<option value="Washington">Washington</option>
						<option value="West Virginia">West Virginia</option>
						<option value="Wisconsin">Wisconsin</option>
						<option value="Wyoming">Wyoming</option>
					</select>
				</td>
			</tr>
			<tr>
				<td>
					<label>Postal Code</label>
				</td>
				<td>
					<input type="text" name="mailingzip" data-label="" value="">
				</td>
			</tr>
			<tr>
				<td>
					<label>Address*</label>
				</td>
				<td>
					<textarea name="mailingstreet" required=""></textarea>
				</td>
			</tr>
			<tr>
				<td>
					<label>Address 2</label>
				</td>
				<td>
					<input type="text" name="address2" data-label="" value="">
				</td>
			</tr>
			<tr>
				<td>
					<label>Phone*</label>
				</td>
				<td>
					<input type="text" name="homephone" data-label="" value="" required="">
				</td>
			</tr>
			<tr>
				<td>
					<label>Ext</label>
				</td>
				<td>
					<input type="number" name="ext" data-label="" value="" datatype="double" step="any">
				</td>
			</tr>
			<!--<tr>
				<td>
					<label>Fax</label>
				</td>
				<td>
					<input type="text" name="fax" data-label="" value="">
				</td>
			</tr>-->
			<tr>
				<td>
					<label>E-mail*</label>
				</td>
				<td>
					<input type="email" name="email" data-label="" value="" required="">
				</td>
			</tr>
			<tr>
				<td>
					<label>Web Page*</label>
				</td>
				<td>
					<input type="text" name="web_page" data-label="" value="" required="">
				</td>
			</tr>
			<tr>
				<td>
					<label>Select your top 2 selling  destinations*</label>
				</td>
				<td>
					<select name="top_selling_destinations[]" id = "top_selling_destinations" data-label="top_selling_destinations" required="" multiple="" style="width: 60%;">
						<option value="Cancún">Cancún</option>
						<option value="Caribbean">Caribbean</option>
						<option value="Disney">Disney</option>
						<option value="Europe">Europe</option>
						<option value="Hawaii">Hawaii</option>
						<option value="Las Vegas">Las Vegas</option>
						<option value="Other Mexico">Other Mexico</option>
						<option value="Rivera Maya Mexico">Rivera Maya Mexico</option>
						<option value="Punta Cana, Dominican Republic">Punta Cana, Dominican Republic</option>
					</select>
				</td>
			</tr>
			<tr>
				<td>
					<label>Select your top 2 specialties*</label>
				</td>
				<td>
					<select name="top_specialities[]" id = "top_specialities" data-label="top_specialities" required="" multiple="" style="width: 60%;">
						<option value="Adult Only">Adult Only</option>
						<option value="Destination Weddings">Destination Weddings</option>
						<option value="Family">Family</option>
						<option value="Groups">Groups</option>
						<option value="Honey Moons &amp; Anniversaries">Honey Moons &amp; Anniversaries</option>
						<option value="Romance">Romance</option>
					</select>
				</td>
			</tr>
			<tr>
				<td>
					<label>Tag Line</label>
				</td>
				<td>
					<input type="text" name="tag_line" data-label="" value="">
				</td>
			</tr>
			<tr>
				<td>
					<label>Company Logo</label>
				</td>
				<td>
					<input type="file" name="imagename[]" data-label="">
				</td>
			</tr>
			<tr>
				<td>
					<label>I agree with Terms &amp; Conditions (<a href="terms_and_conditions.html" target="__blank">Click here</a>)*</label>
				</td>
				<td>
					<input type="hidden" name="accept_conditions" data-label="" value="0">
					<input type="checkbox" name="accept_conditions" data-label="" value="1" required="">
				</td>
			</tr>
		</tbody>
	</table>
	<input type="submit" value="Submit">
</form>
<script  type="text/javascript">
	window.onload = function() { 
		var N=navigator.appName, ua=navigator.userAgent, tem;
		var M=ua.match(/(opera|chrome|safari|firefox|msie)\/?\s*(\.?\d+(\.\d+)*)/i);
		if(M && (tem= ua.match(/version\/([\.\d]+)/i))!= null) M[2]= tem[1];M=M? [M[1], M[2]]: [N, navigator.appVersion, "-?"];
		var browserName = M[0];
		var form = document.getElementById("__vtigerWebForm"), inputs = form.elements; 
		form.onsubmit = function() {
			console.log("aca"); 
			console.log(document.getElementById('top_selling_destinations').value);
			var required = [], att, val; 
			for (var i = 0; i < inputs.length; i++) { 
				att = inputs[i].getAttribute("required"); 
				val = inputs[i].value; 
				type = inputs[i].type; 
				if(type == "email") {
					if(val != "") {
						var elemLabel = inputs[i].getAttribute("label");
						var emailFilter = /^[_/a-zA-Z0-9]+([!"#$%&()*+,./:;<=>?\^_`{|}~-]?[a-zA-Z0-9/_/-])*@[a-zA-Z0-9]+([\_\-\.]?[a-zA-Z0-9]+)*\.([\-\_]?[a-zA-Z0-9])+(\.?[a-zA-Z0-9]+)?$/;
						var illegalChars= /[\(\)\<\>\,\;\:\"\[\]]/ ;
						if (!emailFilter.test(val)) {
							alert("For "+ elemLabel +" field please enter valid email address"); 
							return false;
						} else if (val.match(illegalChars)) {
							alert(elemLabel +" field contains illegal characters");
							return false;
						}
					}
				}
				if (att != null) { 
					if (val.replace(/^\s+|\s+$/g, "") == "") { 
						required.push(inputs[i].getAttribute("label")); 
					} 
				} 
			} 
			if (required.length > 0) { 
				alert("The following fields are required: " + required.join()); 
				return false; 
			} 
			var numberTypeInputs = document.querySelectorAll("input[type=number]");
			for (var i = 0; i < numberTypeInputs.length; i++) { 
				val = numberTypeInputs[i].value;
				var elemLabel = numberTypeInputs[i].getAttribute("label");
				var elemDataType = numberTypeInputs[i].getAttribute("datatype");
				if(val != "") {
					if(elemDataType == "double") {
						var numRegex = /^[+-]?\d+(\.\d+)?$/;
					}
					else{
						var numRegex = /^[+-]?\d+$/;
					}
					if (!numRegex.test(val)) {
						alert("For "+ elemLabel +" field please enter valid number"); 
						return false;
					}
				}
			}
			var dateTypeInputs = document.querySelectorAll("input[type=date]");
			for (var i = 0; i < dateTypeInputs.length; i++) {
				dateVal = dateTypeInputs[i].value;
				var elemLabel = dateTypeInputs[i].getAttribute("label");
				if(dateVal != "") {
					var dateRegex = /^[1-9][0-9]{3}-(0[1-9]|1[0-2]|[1-9]{1})-(0[1-9]|[1-2][0-9]|3[0-1]|[1-9]{1})$/;
					if(!dateRegex.test(dateVal)) {
						alert("For "+ elemLabel +" field please enter valid date in required format"); 
						return false;
					}
				}
			}
			var inputElems = document.getElementsByTagName("input");
			var totalFileSize = 0;
			for(var i = 0; i < inputElems.length; i++) {
				if(inputElems[i].type.toLowerCase() === "file") {
					var file = inputElems[i].files[0];
					if(typeof file !== "undefined") {
						var totalFileSize = totalFileSize + file.size;
					}
				}
			}
			if(totalFileSize > 52428800) {
				alert("Maximum allowed file size including all files is 50MB.");
				return false;}
			}; 
		}
</script>